title: Flex Accounts
description: Manage your User Accounts in Flex.
type: flex-objects

# Extends user account
extends@:
  type: account
  context: blueprints://user

# Flex configuration
config:
  # Administration Configuration (needs Flex-Objects plugin)
  admin:
    # Admin menu
    menu:
      list:
        route: '/accounts'
        title: PLUGIN_ADMIN.USER_ACCOUNTS
        icon: fa-user
        authorize: ['admin.users', 'admin.accounts', 'admin.super']
        priority: 6

    # Admin template type (folder)
    template: grav-accounts

    # List view
    list:
      # Fields shown in the list view
      fields:
        username:
          link: edit
          search: true
        email:
          search: true
        fullname:
          search: true
      # Extra options
      options:
        per_page: 20
        order:
          by: username
          dir: asc

    # Edit view
    edit:
      title:
        template: '{{ object.fullname ?? object.username }} &lt;{{ object.email }}&gt;'

  # Site Configuration
  site:
    # Hide from flex types
    hidden: true
    templates:
      collection:
        # Lookup for the template layout files for collections of objects
        paths:
          - 'flex/{TYPE}/collection/{LAYOUT}{EXT}'
      object:
        # Lookup for the template layout files for objects
        paths:
          - 'flex/{TYPE}/object/{LAYOUT}{EXT}'
      defaults:
        # Default template {TYPE}; overridden by filename of this blueprint if template folder exists
        type: grav-accounts
        # Default template {LAYOUT}; can be overridden in render calls (usually Twig in templates)
        layout: default

  # Data Configuration
  data:
    object: 'Grav\Common\Flex\Users\UserObject'
    collection: 'Grav\Common\Flex\Users\UserCollection'
    index: 'Grav\Common\Flex\Users\UserIndex'
    storage:
      class: 'Grav\Common\Flex\Users\Storage\UserFileStorage'
      options:
        formatter:
          class: 'Grav\Framework\File\Formatter\YamlFormatter'
        folder: 'account://'
        pattern: '{FOLDER}/{KEY}{EXT}'
        key: storage_key
        indexed: true
    search:
      options:
        contains: 1
      fields:
        - key
        - email

# Regular form definition
form:
  fields:
    username:
      flex-disabled@: exists
      disabled: false
      flex-readonly@: exists
      readonly: false
      validate:
        required: true
